# Maintainer: Thomas Wei√üschuh <thomas t-8ch de>

_pkgname='DeDRM_tools'
pkgname='calibre-plugin-dedrm-git'
pkgver='r1869.9bc52a5'
pkgrel='1'
pkgdesc='DeDRM tools for ebooks - Calibre plugin'
arch=('x86_64')
url="https://github.com/noDRM/${_pkgname}"
license=('GPL-3.0-only')
depends=('calibre>=5.15')
makedepends=('unzip' 'zip')
optdepends=('python-pycryptodome: for crytographic primitives')
provides=("${_pkgname}")
conflicts=("${_pkgname}")
source=("git+${url}.git")
sha512sums=('SKIP')

build() {
	cd "${_pkgname}"
    python3 make_release.py
}

package() {
	cd "${_pkgname}"
	unzip -d build DeDRM_tools.zip
	install -Dm 0644 -t "${pkgdir}/usr/share/calibre/system-plugins" build/*plugin*
	install -Dm 0644 -t "${pkgdir}/usr/share/doc/${pkgname}" build/*README*
}
